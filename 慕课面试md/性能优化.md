# 性能优化

## 图片优化

了解了如何计算图片大小的知识，那么对于如何优化图片，想必大家已经有 2 个思路了：

- **减少像素点**
- **减少每个像素点能够显示的颜色**

不用图片。很多时候会使用到很多修饰类图片，其实这类修饰图片完全可以用 CSS 去代替

小图使用 base64 格式

将多个图标文件整合到一张图片中（雪碧图）



## DNS 预解析

DNS 解析也是需要时间的，可以通过预解析的方式来预先获得域名所对应的 IP。

```html
<link rel="dns-prefetch" href="//yuchengkai.cn">
```



## 节流

考虑一个场景，滚动事件中会发起网络请求，但是我们并不希望用户在滚动过程中一直发起请求，而是`隔一段时间发起一次`，对于这种情况我们就可以使用节流。





## 防抖

有一个按钮点击会触发网络请求，但是我们并不希望每次点击都发起网络请求，而是`当用户点击按钮一段时间后没有再次点击的情况`才去发起网络请求，



## 预加载

预加载其实是声明式的 `fetch` ，强制浏览器请求资源，并且不会阻塞 `onload` 事件，可以使用以下代码开启预加载

```js
<link rel="preload" href="http://example.com">
```



## 预渲染

可以通过预渲染将下载的文件预先在后台渲染，可以使用以下代码开启预渲染

```js
<link rel="prerender" href="http://example.com"> 
```





## 懒加载

懒加载的原理就是`只加载自定义区域`（通常是可视区域，但也可以是即将进入可视区域）内需要加载的东西。

对于图片来说，

1. 先设置图片标签的 `src` 属性为一张占位图，
2. 将真实的图片资`源放入一个自定义属性中`(<img data-src="xxx.jpg"/>)，
3. 当进入自定义区域时，就将自定义属性替换为 `src` 属性，这样图片就会去下载资源，实现了图片懒加载。

懒加载不仅可以用于图片，也可以使用在别的资源上。比如进入可视区域才开始播放视频等等

## CDN

CDN 的原理是尽可能的在`各个地方分布机房缓存数据`，这样即使我们的根服务器远在国外，在国内的用户也可以通过国内的机房迅速加载资源。